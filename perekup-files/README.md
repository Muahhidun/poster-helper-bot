# üöó –ê–≤—Ç–æ-–ú—É—à–∞—Ä–∞–∫–∞

Telegram-–±–æ—Ç –¥–ª—è —É—á–µ—Ç–∞ –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Å —Ä–∞—Å—á–µ—Ç–æ–º –ø—Ä–∏–±—ã–ª–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫–∞–ø–∏—Ç–∞–ª–æ–º.

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ (–∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π), –ø—Ä–æ–¥–∞–∂–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—á–µ—Ç–æ–º –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ **–£—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø—Ä–æ–µ–∫—Ç—ã –∏ –æ–±—â–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–æ–º** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞, –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –∏–Ω–∫–∞—Å—Å–∞—Ü–∏—è
- ‚úÖ **–û—Ç—á–µ—Ç—ã** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º, –±–∞–ª–∞–Ω—Å—É –∫–∞–ø–∏—Ç–∞–ª–∞
- ‚úÖ **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ 22:00 (–ê–ª–º–∞—Ç—ã)

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.11+
- aiogram 3.x (Telegram Bot API)
- SQLAlchemy 2.x (ORM)
- PostgreSQL
- APScheduler (–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á)
- Railway (–¥–µ–ø–ª–æ–π)

## üöÄ –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/Muahhidun/perekup.git
cd perekup
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env`:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
ALLOWED_USER_IDS=167084307,296406246
DATABASE_URL=postgresql://user:password@localhost:5432/perekup
INITIAL_CAPITAL=2000000
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL

–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```bash
createdb perekup
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker:

```bash
docker run -d \
  --name perekup-postgres \
  -e POSTGRES_DB=perekup \
  -e POSTGRES_USER=user \
  -e POSTGRES_PASSWORD=password \
  -p 5432:5432 \
  postgres:15
```

### 6. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python main.py
```

## üì¶ –î–µ–ø–ª–æ–π –Ω–∞ Railway

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Railway

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [railway.app](https://railway.app)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –î–æ–±–∞–≤—å—Ç–µ PostgreSQL:
   - New ‚Üí Database ‚Üí PostgreSQL

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞

1. New ‚Üí GitHub Repo ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ `perekup`
2. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç `Dockerfile`

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–±–∞–≤—å—Ç–µ:

```
TELEGRAM_BOT_TOKEN=8524103967:AAG2azpPa8QEUWukqbrxtLw5hThrrQa50Sc
ALLOWED_USER_IDS=167084307,296406246
INITIAL_CAPITAL=2000000
DAILY_REPORT_TIME=22:00
TIMEZONE=Asia/Almaty
```

**DATABASE_URL** –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω –∏–∑ PostgreSQL —Å–µ—Ä–≤–∏—Å–∞.

### 4. –î–µ–ø–ª–æ–π

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –±–æ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
perekup/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py    # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ states.py       # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middlewares.py  # Middleware
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py     # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models.py       # –ú–æ–¥–µ–ª–∏ SQLAlchemy
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ report_service.py  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ formatters.py   # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ README.md
```

## üóÑ –ú–æ–¥–µ–ª–∏ –ë–î

### Project
–ê–≤—Ç–æ–º–æ–±–∏–ª–∏ (–ø—Ä–æ–µ–∫—Ç—ã):
- title, vin, buy_date, buy_price
- sell_date, sell_price, status
- –°–≤—è–∑—å —Å Expense –∏ Income

### Expense
–†–∞—Å—Ö–æ–¥—ã:
- amount, category, description, date
- project_id (nullable - –¥–ª—è –æ–±—â–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤)
- payer (author/serik/common)

### Income
–î–æ—Ö–æ–¥—ã (–ø—Ä–æ–¥–∞–∂–∞):
- amount, date, source
- project_id

### CapitalOperation
–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–∞–ø–∏—Ç–∞–ª–æ–º:
- type (initial/deposit/withdrawal)
- amount, who, notes

## üìà –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –†–∞—Å—á–µ—Ç –±–∞–ª–∞–Ω—Å–∞ –∫–∞–ø–∏—Ç–∞–ª–∞

```
–ë–∞–ª–∞–Ω—Å = –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª
         + –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è
         - –ò–Ω–∫–∞—Å—Å–∞—Ü–∏–∏
         - –í–ª–æ–∂–µ–Ω–æ –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
         - –û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã
```

### –†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É

```
–í–ª–æ–∂–µ–Ω–∏—è = buy_price + —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø—Ä–æ–µ–∫—Ç
–ü—Ä–∏–±—ã–ª—å = sell_price - –≤–ª–æ–∂–µ–Ω–∏—è
–î–æ–ª—è –∫–∞–∂–¥–æ–≥–æ = –ø—Ä–∏–±—ã–ª—å / 2
```

## üë• –ü–∞—Ä—Ç–Ω–µ—Ä—ã

- **–ñ–∞–Ω–¥–æ—Å** (ID: 167084307) - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞–ø–∏—Ç–∞–ª
- **–°–µ—Ä–∏–∫** (ID: 296406246) - –ø–µ—Ä–µ–∫—É–ø—â–∏–∫

–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã (—Ç–∞–∫—Å–∏, –æ–±–µ–¥, –ø–æ–¥–ø–∏—Å–∫–∏) –Ω–µ—Å–µ—Ç –ñ–∞–Ω–¥–æ—Å –∏–∑ –∫–∞–ø–∏—Ç–∞–ª–∞.
–ü—Ä–∏–±—ã–ª—å –¥–µ–ª–∏—Ç—Å—è 50/50.

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:
- ‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å
- üí∏ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ç—Ä–∞—Ç—ã
- üí∞ –ü—Ä–æ–¥–∞—Ç—å –∞–≤—Ç–æ - –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç —Å —Ä–∞—Å—á–µ—Ç–æ–º –ø—Ä–∏–±—ã–ª–∏
- üìä –ë–∞–ª–∞–Ω—Å –∫–∞–ø–∏—Ç–∞–ª–∞ - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- üìà –û—Ç—á—ë—Ç—ã - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ - –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ/–∏–Ω–∫–∞—Å—Å–∞—Ü–∏—è

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç (22:00):
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ–±–æ–∏–º –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º:
- –ë–∞–ª–∞–Ω—Å –∫–∞–ø–∏—Ç–∞–ª–∞
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
- –û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–∞–º
- –ò–Ω–∫–∞—Å—Å–∞—Ü–∏–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ user_id –≤ `.env`
- Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø
- `.env` –≤ `.gitignore`
- –°–µ–∫—Ä–µ—Ç—ã —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- Telegram: @muahhidun
- GitHub: [Muahhidun](https://github.com/Muahhidun)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
